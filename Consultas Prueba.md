# Casos de Prueba

### Inserción Tabla Programa

```SQL
INSERT INTO "SYSTEM"."PROGRAMA" (IDPROGRAMA, NOMBREPROGRAMA) 
VALUES ('3', 'Java');
```

### Inserción Tabla Pregunta

```SQL
INSERT INTO "SYSTEM"."PREGUNTA" (IDPREGUNTA, IDPRUEBA, ENUNCIADOPREGUNTA, PUNTAJEPREGUNTA) 
VALUES ('29', '2', 'Pregunta1', '1');

INSERT INTO "SYSTEM"."PREGUNTA" (IDPREGUNTA, IDPRUEBA, ENUNCIADOPREGUNTA, PUNTAJEPREGUNTA) 
VALUES ('30', '2', 'Pregunta2', '1');
```

### Inserción Tabla Alternativa

```SQL
INSERT INTO "SYSTEM"."ALTERNATIVA" (IDALTERNATIVA, IDPREGUNTA, RESPUESTAALTERNATIVA, PORCENTAJE, ESCORRECTA) 
VALUES ('113', '29', 'Alternativa1', '0', 'S');
```

# Consultas

## Pregunta 1 

Conocer el número de evaluaciones por curso.

```SQL
SELECT PROGRAMA.IDPROGRAMA AS PROGRAMA, COUNT (PRUEBA.IDPRUEBA) AS CANTIDAD
FROM PROGRAMA
LEFT OUTER JOIN PRUEBA ON PRUEBA.IDPROGRAMA = PROGRAMA.IDPROGRAMA
GROUP BY PROGRAMA.IDPROGRAMA;
```

## Pregunta 2

Conocer los cursos sin evaluaciones.

```SQL
SELECT * FROM 
(SELECT PROGRAMA.IDPROGRAMA AS PROGRAMA, COUNT (PRUEBA.IDPRUEBA) AS CANTIDAD
FROM PROGRAMA
LEFT OUTER JOIN PRUEBA ON PRUEBA.IDPROGRAMA = PROGRAMA.IDPROGRAMA
GROUP BY PROGRAMA.IDPROGRAMA)
WHERE CANTIDAD = 0 ;
```

## Pregunta 3

Determinar las evaluaciones con deficiencia. Una evaluación es deficiente:
a. Si no tiene preguntas.
b. Si hay preguntas con 2 ó menos alternativas
c. Si todas las alternativas son correctas o si todas las alternativas son incorrectas.

```SQL
SELECT PRUEBA, 'No tiene preguntas' AS MOTIVO
FROM (SELECT PRUEBA.IDPRUEBA AS PRUEBA, COUNT (PREGUNTA.IDPREGUNTA) AS CANTIDAD_PREGUNTAS
    FROM PREGUNTA
    RIGHT JOIN PRUEBA ON PRUEBA.IDPRUEBA = PREGUNTA.IDPRUEBA
    GROUP BY PRUEBA.IDPRUEBA)
WHERE CANTIDAD_PREGUNTAS = 0
UNION
SELECT PRUEBA, 'No tiene alternativas' AS MOTIVO
FROM (SELECT PREGUNTA.IDPRUEBA AS PRUEBA, PREGUNTA.IDPREGUNTA AS PREGUNTA, COUNT (ALTERNATIVA.IDPREGUNTA) AS ALTERNATIVA
    FROM PREGUNTA
    LEFT OUTER JOIN ALTERNATIVA ON ALTERNATIVA.IDPREGUNTA = PREGUNTA.IDPREGUNTA
    GROUP BY PREGUNTA.IDPREGUNTA, PREGUNTA.IDPRUEBA
    ORDER BY PREGUNTA.IDPREGUNTA)
WHERE ALTERNATIVA <= 2
GROUP BY PRUEBA
UNION
SELECT PREGUNTA.IDPRUEBA, 'Alternativas incorrectas' AS MOTIVO
FROM (SELECT IDPREGUNTA AS PREGUNTA, ESCORRECTA AS RESPUESTA, COUNT(IDPREGUNTA) AS CONTAR
    FROM ALTERNATIVA
    GROUP BY  IDPREGUNTA, ESCORRECTA
    ORDER BY IDPREGUNTA)
INNER JOIN PREGUNTA ON PREGUNTA.IDPREGUNTA = PREGUNTA
WHERE CONTAR = 1 OR CONTAR = 4;
```

## Pregunta 4

Determinar cuántos alumnos hay en cada curso.

```SQL
SELECT IDPROGRAMA AS PROGRAMA, COUNT(IDALUMNO) as CANTIDAD_ALUMNOS
FROM ALUMNOPROGRAMA
GROUP BY IDPROGRAMA;
```

## Pregunta 5

Obtener el puntaje no normalizado de cada evaluación. El puntaje no normalizado ha sido definido (requerimiento) como: P = buenas – malas/4. Si un alumno no contesta en una pregunta exactamente lo mismo que se ha definido como correcto, la pregunta cuenta como mala a menos que el alumno haya omitido.

```SQL
SELECT RESPUESTAALUMNO.IDALUMNO AS ALUMNO, RESPUESTAALUMNO.IDPRUEBA AS PRUEBA, ((COUNT(CASE WHEN ALTERNATIVA.ESCORRECTA = 'S' THEN 1 END) - COUNT(CASE WHEN ALTERNATIVA.ESCORRECTA = 'N' THEN 1 END))/4) AS NORMALIZADO
FROM RESPUESTAALUMNO
INNER JOIN ALTERNATIVA ON RESPUESTAALUMNO.IDALTERNATIVA = ALTERNATIVA.IDALTERNATIVA
GROUP BY RESPUESTAALUMNO.IDPRUEBA, RESPUESTAALUMNO.IDALUMNO
ORDER BY RESPUESTAALUMNO.IDALUMNO;
```

## Pregunta 6

Obtener el puntaje normalizado, o sea, de 1,0 a 7,0.

```SQL
SELECT RESPUESTAALUMNO.IDALUMNO AS ALUMNO, RESPUESTAALUMNO.IDPRUEBA AS PRUEBA, (((COUNT(CASE WHEN ALTERNATIVA.ESCORRECTA = 'S' THEN 1 END) - COUNT(CASE WHEN ALTERNATIVA.ESCORRECTA = 'N' THEN 1 END))*7)/28) AS NORMALIZADO
FROM RESPUESTAALUMNO
INNER JOIN ALTERNATIVA ON RESPUESTAALUMNO.IDALTERNATIVA = ALTERNATIVA.IDALTERNATIVA
GROUP BY RESPUESTAALUMNO.IDPRUEBA, RESPUESTAALUMNO.IDALUMNO
ORDER BY RESPUESTAALUMNO.IDALUMNO;
```

## Pregunta 7

Nombre de estudiantes de un curso determinado que aprueban una evaluación determinada (donde la nota de aprobación mínima es un 4,0).

```SQL
SELECT ALUMNO.NOMBREALUMNO AS NOMBRE_ALUMNO, NORMALIZADO AS APROBADOS
FROM
(SELECT RESPUESTAALUMNO.IDALUMNO AS ALUMNO, RESPUESTAALUMNO.IDPRUEBA AS PRUEBA, 
(((COUNT(CASE WHEN ALTERNATIVA.ESCORRECTA = 'S' THEN 1 END) - COUNT(CASE WHEN ALTERNATIVA.ESCORRECTA = 'N' THEN 1 END))*7)/28) AS NORMALIZADO
FROM RESPUESTAALUMNO
INNER JOIN ALTERNATIVA ON RESPUESTAALUMNO.IDALTERNATIVA = ALTERNATIVA.IDALTERNATIVA
GROUP BY RESPUESTAALUMNO.IDPRUEBA, RESPUESTAALUMNO.IDALUMNO
ORDER BY RESPUESTAALUMNO.IDALUMNO)
INNER JOIN ALUMNO ON ALUMNO.IDALUMNO = ALUMNO
WHERE NORMALIZADO >= 4;
```

## Pregunta 8

Nota promedio de los estudiantes de un curso determinado, para una evaluación de terminada.

```SQL
SELECT PRUEBA AS PRUEBA, AVG(NORMALIZADO) AS PROMEDIO
FROM (
SELECT RESPUESTAALUMNO.IDALUMNO AS ALUMNO, RESPUESTAALUMNO.IDPRUEBA AS PRUEBA, 
(((COUNT(CASE WHEN ALTERNATIVA.ESCORRECTA = 'S' THEN 1 END) - COUNT(CASE WHEN ALTERNATIVA.ESCORRECTA = 'N' THEN 1 END))*7)/28) AS NORMALIZADO
FROM RESPUESTAALUMNO
INNER JOIN ALTERNATIVA ON RESPUESTAALUMNO.IDALTERNATIVA = ALTERNATIVA.IDALTERNATIVA
GROUP BY RESPUESTAALUMNO.IDPRUEBA, RESPUESTAALUMNO.IDALUMNO
ORDER BY RESPUESTAALUMNO.IDALUMNO)
WHERE PRUEBA = 1
GROUP BY PRUEBA;
```
